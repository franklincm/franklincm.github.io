<!DOCTYPE html>
<html>
    <head>
      <meta charset="UTF-8">
      <!-- Bootstrap -->
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" media="screen" href="/css/bootstrap.min.css">
      <link href="/css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">
      <!-- syntax highlighting -->
      <link rel="stylesheet" href="/css/pygments/native.css">
      <!-- Overrides -->
      <link rel="stylesheet" href="/css/layout.css">
      <link rel="stylesheet" href="/css/chemistryregular.css">
      <link rel="stylesheet" href="/css/solarized-light.css">
      <link rel="stylesheet" href="/css/navtree-ascii-solarized-light.css">
      <link rel="stylesheet" href="/css/powerline-solarized-light.css">
      <link rel="icon" href="/img/favicon.ico?v=2" sizes="16x16 24x24 32x32 64x64" type="image/vnd.microsoft.icon">
      <!-- mathjax -->
      <script type="text/javascript" src="/js/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <title>PyPI packaging with setuptools - miscBitsOfData</title>
    </head>
    <body>

        <div class="container">
            <a href="/"><h1 class="title">// miscbitsofdata</h1></a>

            <div class="main">
                <div class="side">
		    <div class="navtree-ascii">
    <span class="nav drop">[-]&nbsp;~/<br />
	&nbsp;|~&nbsp;<a href="/">posts</a><br />
        &nbsp;|&nbsp;&nbsp;|<br />
	&nbsp;|&nbsp;&nbsp;`-<a href="/by-year">by year</a><br />
        &nbsp;|<br />
	&nbsp;|~&nbsp;odds & ends<br />
        &nbsp;|&nbsp;&nbsp;|<br />
	&nbsp;|&nbsp;&nbsp;`-<a href="/calendar/index.php">calendar</a><br />
	&nbsp;|<br />
	&nbsp;`~&nbsp;<a href="/tags/index.html">tags</a><br />
    </span>
    <span class="nav fill">
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
      ~<br />
    </span>
</div>

                </div>
                <div class="view ">
                    <div class="content">
			<div class="post">
    <h1>PyPI packaging with setuptools</h1>
    <date>04 Feb 2014</date>
    
    <author>Author: <span>chase</span></author>
    
    <hr />
    <p>I recently submitted my first package to the <a href="https://pypi.python.org/pypi">Python Package Index (PyPI)</a> as an exercise to become familiar with the process. If you google &#39;python packaging&#39; you&#39;re likely to discover a frustrating labyrinth of ambiguity. Python packaging in general is a bit of a mess because of all the different standards and tools available. Some guides suggest <a href="http://docs.python.org/2/library/distutils.html">distutils</a> for basic functionality, others <a href="http://pythonhosted.org/an_example_pypi_project/setuptools.html">setuptools</a> and/or <a href="http://pythonhosted.org/distribute/">distribute</a>. For the record, <strong><em>USE SETUPTOOLS</em></strong>. I won&#39;t go into the history/reasons for the existence of the others. If you&#39;re so inclined, <a href="http://www.google.com">google</a> is your friend. Following are the basics of how I managed to get mine successfully built/submitted/installed:</p>

<h2>1. Directory Structure</h2>

<p>First, my code was a mess. I had 5 separate files, vaguely separated by function. Depending on how you&#39;re project is organized, the standard directory structure for a package should look something like one of these two:</p>

<p>Exibit A: <em>single file</em></p>

<figure class="code"><figcaption></figcaption>
<div class="highlight"><pre><code class="bash">mypackage/
    <span class="p">|</span>- mymodule.py
    <span class="p">|</span>- setup.py
    <span class="p">|</span>- MANIFEST.in
    <span class="p">|</span>- README.rst
    <span class="sb">`</span>- LICENSE.rst
</code></pre></div>
</figure>

<p>Exibit B: <em>multiple files</em></p>

<figure class="code"><figcaption></figcaption>
<div class="highlight"><pre><code class="bash">mypackage/
    <span class="p">|</span>- mymodule/
    <span class="p">|</span>    <span class="p">|</span>- __init__.py
    <span class="p">|</span>    <span class="p">|</span>- file1.py
    <span class="p">|</span>    <span class="p">|</span>- file2.py
    <span class="p">|</span>    <span class="p">|</span>- file3.py
    <span class="p">|</span>    <span class="sb">`</span>- file4.py
    <span class="p">|</span>- setup.py
    <span class="p">|</span>- MANIFEST.in
    <span class="p">|</span>- README.rst
    <span class="sb">`</span>- LICENSE.rst
</code></pre></div>
</figure>

<p>So since I have 5 separate files, my package directory looks like this:</p>

<figure class="code"><figcaption></figcaption>
<div class="highlight"><pre><code class="bash">dotcolors/
    <span class="p">|</span>- dotcolors/
    <span class="p">|</span>    <span class="p">|</span>- __init__.py
    <span class="p">|</span>    <span class="p">|</span>- cli.py
    <span class="p">|</span>    <span class="p">|</span>- core.py
    <span class="p">|</span>    <span class="p">|</span>- getdots.py
    <span class="p">|</span>    <span class="p">|</span>- settings.py
    <span class="p">|</span>    <span class="sb">`</span>- utils.py
    <span class="p">|</span>- setup.py
    <span class="p">|</span>- README.rst
    <span class="sb">`</span>- LICENSE.rst
</code></pre></div>
</figure>

<h2>2. setup.py</h2>

<p>This is the most important aspect. <code>setup.py</code> tells setuptools how to do what with you package.</p>

<p>my setup.py:</p>

<figure class="code"><figcaption></figcaption>
<div class="highlight"><pre><code class="python"><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>

<span class="n">setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;dotcolors&#39;</span><span class="p">,</span>
      <span class="n">version</span><span class="o">=</span><span class="s">&#39;0.1&#39;</span><span class="p">,</span>
      <span class="n">description</span><span class="o">=</span><span class="s">&#39;manage Xresources colors from dotshare.it&#39;</span><span class="p">,</span>
      <span class="n">url</span><span class="o">=</span><span class="s">&#39;http://github.com/gnullbyte/dotcolors&#39;</span><span class="p">,</span>
      <span class="n">author</span><span class="o">=</span><span class="s">&#39;Chase Franklin&#39;</span><span class="p">,</span>
      <span class="n">author_email</span><span class="o">=</span><span class="s">&#39;jakhead@gmail.com&#39;</span><span class="p">,</span>
      <span class="n">packages</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;dotcolors&#39;</span><span class="p">],</span>
      <span class="n">py_modules</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;dotcolors&#39;</span><span class="p">],</span>
      <span class="n">license</span><span class="o">=</span><span class="s">&#39;MIT&#39;</span><span class="p">,</span>
      <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
          <span class="s">&#39;BeautifulSoup&#39;</span><span class="p">,</span>
          <span class="s">&#39;progressbar&#39;</span><span class="p">,</span>
          <span class="s">&#39;docopts&#39;</span>
          <span class="p">],</span>
      <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
          <span class="s">&#39;console_scripts&#39;</span><span class="p">:</span>
          <span class="p">[</span><span class="s">&#39;dotcolors = dotcolors.cli:main&#39;</span><span class="p">]</span>
          <span class="p">}</span>
      <span class="p">)</span>
</code></pre></div>
</figure>

<p>Version, description, url, author, author_email, and license should all be pretty self explanatory. The important ones I had to learn about here are packages, py_modules, install_requires, and entry_points.</p>

<h3>packages</h3>

<p>This is the name of the subdirectory containing the files I want included in my package.</p>

<h3>py_modules</h3>

<p>This is the name of the module to register. Not strictly necessary, but it is in this case as I want to use <code>entry_points</code> to generate a command line script.</p>

<h3>install_requires</h3>

<p>Dependencies. This can use easy_install format i.e. <code>&#39;BeautifulSoup&gt;=3.2.1&#39;</code> or <code>&#39;BeautifulSoup==3.2.1&#39;</code>. This tells setuptools to process and install whatever dependencies your module requires.</p>

<h3>entry_points</h3>

<p>Here&#39;s the kicker in my case. I wanted my package to be callable from the command line. Accomplish this with the</p>

<figure class="code"><figcaption></figcaption>
<div class="highlight"><pre><code class="bash"><span class="s1">&#39;console_scripts&#39;</span> : <span class="s1">&#39;[name of script] = myModule.module:callable&#39;</span>
</code></pre></div>
</figure>

<h3>Test!</h3>

<figure class="code"><figcaption></figcaption>
<div class="highlight"><pre><code class="python"><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</code></pre></div>
</figure>

<p>You should know how to uninstall python packages before you run this, but you should definitely test to make sure everything installs well before proceeding. May the force be with you...</p>

<h2>3. PyPI</h2>

<p>Assuming everything is legit, time to package.</p>

<ol>
<li><code>python setup.py sdist</code></li>
<li><code>python setup.py register</code></li>
<li><code>python setup.py sdist upload</code></li>
</ol>

<p>In order, this packages your module, registers it on <a href="https://pypi.python.org/pypi">PyPi</a> (user account required or you can setup up one at the prompt, confirm email and re-run step 2), and uploads it to the index.</p>

<p>To test:</p>

<figure class="code"><figcaption></figcaption>
<div class="highlight"><pre><code class="bash">sudo pip install myPackage
</code></pre></div>
</figure>

    <hr />

    
    <p><span>Chase Franklin</span> : <a href="https://github.com/gnullbyte">github.com/gnullbyte</a><br/>
<pre class="contact">echo sjtqnjm.pvjru@lxv | tr a-z@. r-za-q.@</pre><br /></p>

    
    <span class="random">/dev/random</span>
    <blockquote class="fortune"><pre>Here, stand behind me. Yeah, just like that. Just like you're doing.
Things are about to get real messy.
</pre></blockquote>
</div>

                    </div>
                </div>

            </div> <!-- main -->
	    <div class="powerline">
  <div class="text-left1">
    <a href="">&nbsp; mbod </a>
  </div>
  <div class="l1"></div>
  <div class="text-left2 hidden-xs hidden-sm ">PyPI-packaging-with-setuptools.html</div>
  <div class="l2"></div>
  <div class="git"></div>
  <div class="text-left3 hidden-xs">&nbsp;working</div>
  <div class="l3"></div>
  <div class="text-left4 hidden-xs">current</div>
  <div class="l4"></div>
  <span class=""><!-- center text --></span>
  <div class="text-right1">linux&nbsp;</div>
  <div class="r1"></div>
  <div class="text-right2 hidden-xs">programming</div>
  <div class="r2"></div>
  <div class="text-right3 hidden-xs hidden-sm">rants</div>
  <div class="r3"></div>
</div>

            <div class="footer">&copy; 2014 miscbitsofdata.com</div>
        </div><!-- container -->

      <!--  bootstrap js  -->
<script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/eHeight.js"></script>
<script type="text/javascript" src="/js/aHeight.js"></script>
<!-- <script type="text/javascript" src="/js/fill.js"></script> -->

    </body>
</html>
